format_version: "5"
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git
app:
  envs:
  - OPTIONS: -Z
  - OS: macos
  - VERSION: latest
workflows:
  test:
    steps:
    - activate-ssh-key@4:
        run_if: '{{getenv "SSH_RSA_PRIVATE_KEY" | ne ""}}'
    - git-clone@8: {}
    - script:
        inputs:
        - content: |-
            pip3 install -r app/requirements.txt
            pytest --cov app
            pwd
    - path::/Users/vagrant/git:
        title: Step Test
    - script:
        title: Step audit
        inputs:
        - content: |-
            #!/bin/bash
            set -ex
            stepman audit --step-yml ./step.yml
  audit-this-step:
    steps:
    - script:
        inputs:
        - content: |-
            #!/bin/bash
            set -ex
            stepman audit --step-yml ./step.yml
trigger_map:
- push_branch: main
  workflow: test
- pull_request_target_branch: main
  workflow: test
